# レポートの自動生成

Webからデータをダウンロードして、データベースに保存しただけでは意味がありません。
保存したデータを解析して、レポートとして出力する必要があります。

## レポートを自動的に生成する

Webダウンロードしたデータをそのままレポートとして出力することはまれでしょう。
たいていの場合、何らかの分析や集計を行ったうえで、レポートとして出力するケースが多いと思います。
どんな、レポートを出力できるのか、その出力形式や、どんなライブラリを利用できるのかを解説します。

### レポートを出力する目的をはっきりさせよう

され、なんの為にレポートを出力するのでしょうか。
そもそも、レポートを書く目的は「自分の考えや主張、それらを形にして自分自身と誰かに報告する為」です。
自分自身のなかではっきりとさせたいことや、誰かに伝えたいことをレポートとしてまとめるのです。

もちろん、完全なレポートをJavaScriptのプログラムだけで生成することはできません。
プログラムでは、レポートの参考資料を自動生成したらするというのが相応しいでしょう。

したがって、レポートを自動生成するには、「誰に何を伝えるのか」という部分を意識して選定するのが良いと思います。

## 出力形式について

ここでは、どんなレポートを誰の為に出力するのかの部分にフォーカスをして考えてみましょう。

### レポートをWebで公開する場合

まず、Webでレポートを公表ｓると言う前提があるのであれば、HTMLやPDFで出力することになるでしょう。
また、ExcelやWord形式でデータが配布されているのも見かけます。
これらの形式では、Webブラウザーからダウンロードした上で見てもらうことになるので、一段階、手間がかかりますが、ExcelあｙWordであれば、誰もが持っているアプリを利用して見てもらうことが出来ます。

他にも、特定の目的を持って配布されているデータ形式もあります。

**Webで公開するレポート**
| ファイル形式           | 特徴                                          |
| :--------------------- | :-------------------------------------------- |
| HTML形式               | Webブラウザーで見られる                       |
| PDF形式                | Webブラウザーの中でビューワーが開いて見られる |
| Excel/Word形式         | ダウンロードしてローカルで見てもらう          |
| 専門分野のファイル形式 | 特定のアプリでダウンロードしてみてもらう      |

### 自分用にレポートを出力する場合

自分用にレポートを出力することを考えてみましょう。
自分用であれば、それほど、形式や出力品質にこだわる必要はないでしょう。
分析や集計の結果が直感的にわかる形式で十分です。
ですから、最低限のデータと言うことで、テキストファイルで出力しても問題無いでしょうし、テキストデータに簡単に見出しや段落を付けた、HTMLファイルを生成するのも、ほとんど手間が掛からないのでお勧めです。
加えて、自分用であれば、CSV形式を出力するだけでも十分でしょう。CSV形式はテキストデータをカンマと改行で区切っただけの物ですから、データの作成は簡単です。
しかし、Excelなどの表計算アプリでデータ読み込む事で、手軽でありながら、リッチなレポートして見ることができます。
CSV形式と同じように、XML形式でも出力できるでしょう。多くのWebブラウザーはXML形式のデータをきれいに色分けして、タグの階層に分けて表示する機能を備えています。
また、HTMLを書くのと、それほど手間は変わらないものの、WIKI記法やMarkdown形式で書き出す事も検討できます。と言うのは、これらのデータは手軽にHTMLやPDFなどのファイル形式に変換することができるからです。

**自分向けレポート**
| フォーマット          | 特徴                                          |
| :-------------------- | :-------------------------------------------- |
| テキスト形式          | 手間がかからない                              |
| HTML形式              | 簡単なタグ付で見栄えもよくなる                |
| CSV形式               | Excelなどの表計算アプリで読み込めば見栄えいい |
| XML形式               | Webブラウザーの中にはきれいに表現してくれる   |
| WIKI記法/Markdown形式 | 手軽にHTMLやPDFに出力できる                   |

### レポートを印刷する場合

## PDF形式ファイルの作成

### 簡単にPDFを作る方法

### PhantomJSでHTMLをPDFとして出力する方法

### PDFKitを利用して出力する

### PDFKitでグラフを描く

### PDFKitのより詳しい情報

## Excel形式ファイル作成

## Node.js + Officegen を使う方法

## Rhino と Apache POI を使う方法

### その他の方法

## Web API で取得した値をExcelに書き込む
